Calendar=function(k,l,i,h){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=i||null;this.onClose=h||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT.DEF_DATE_FORMAT;this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT;this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof k=="number"?k:Calendar._FD;this.showsOtherMonths=false;this.dateStr=l;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var g=new Array();for(var j=8;j>0;){g[--j]=Calendar._DN[j].substr(0,Calendar._SDN_len)}Calendar._SDN=g;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}g=new Array();for(var j=12;j>0;){g[--j]=Calendar._MN[j].substr(0,Calendar._SMN_len)}Calendar._SMN=g}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(j){var h=0,k=0;var l=/^div$/i.test(j.tagName);if(l&&j.scrollLeft){h=j.scrollLeft}if(l&&j.scrollTop){k=j.scrollTop}var i={x:j.offsetLeft-h,y:j.offsetTop-k};if(j.offsetParent){var g=this.getAbsolutePos(j.offsetParent);i.x+=g.x;i.y+=g.y}return i};Calendar.isRelated=function(h,f){var g=f.relatedTarget;if(!g){var e=f.type;if(e=="mouseover"){g=f.fromElement}else{if(e=="mouseout"){g=f.toElement}}}while(g){if(g==h){return true}g=g.parentNode}return false};Calendar.removeClass=function(h,i){if(!(h&&h.className)){return}var g=h.className.split(" ");var f=new Array();for(var j=g.length;j>0;){if(g[--j]!=i){f[f.length]=g[j]}}h.className=f.join(" ")};Calendar.addClass=function(c,d){Calendar.removeClass(c,d);c.className+=" "+d};Calendar.getElement=function(d){var c=Calendar.is_ie?window.event.srcElement:d.currentTarget;while(c.nodeType!=1||/^div$/i.test(c.tagName)){c=c.parentNode}return c};Calendar.getTargetElement=function(d){var c=Calendar.is_ie?window.event.srcElement:d.target;while(c.nodeType!=1){c=c.parentNode}return c};Calendar.stopEvent=function(b){b||(b=window.event);if(Calendar.is_ie){b.cancelBubble=true;b.returnValue=false}else{b.preventDefault();b.stopPropagation()}return false};Calendar.addEvent=function(e,f,d){if(e.attachEvent){e.attachEvent("on"+f,d)}else{if(e.addEventListener){e.addEventListener(f,d,true)}else{e["on"+f]=d}}};Calendar.removeEvent=function(e,f,d){if(e.detachEvent){e.detachEvent("on"+f,d)}else{if(e.removeEventListener){e.removeEventListener(f,d,true)}else{e["on"+f]=null}}};Calendar.createElement=function(f,d){var e=null;if(document.createElementNS){e=document.createElementNS("http://www.w3.org/1999/xhtml",f)}else{e=document.createElement(f)}if(typeof d!="undefined"){d.appendChild(e)}return e};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(b){if(typeof b.month!="undefined"){return b}else{if(typeof b.parentNode.month!="undefined"){return b.parentNode}}return null};Calendar.findYear=function(b){if(typeof b.year!="undefined"){return b}else{if(typeof b.parentNode.year!="undefined"){return b.parentNode}}return null};Calendar.showMonthsCombo=function(){var j=Calendar._C;if(!j){return false}var j=j;var i=j.activeDiv;var k=j.monthsCombo;if(j.hilitedMonth){Calendar.removeClass(j.hilitedMonth,"hilite")}if(j.activeMonth){Calendar.removeClass(j.activeMonth,"active")}var l=j.monthsCombo.getElementsByTagName("div")[j.date.getMonth()];Calendar.addClass(l,"active");j.activeMonth=l;var g=k.style;g.display="block";if(i.navtype<0){g.left=i.offsetLeft+"px"}else{var h=k.offsetWidth;if(typeof h=="undefined"){h=50}g.left=(i.offsetLeft+i.offsetWidth-h)+"px"}g.top=(i.offsetTop+i.offsetHeight)+"px"};Calendar.showYearsCombo=function(q){var t=Calendar._C;if(!t){return false}var t=t;var r=t.activeDiv;var o=t.yearsCombo;if(t.hilitedYear){Calendar.removeClass(t.hilitedYear,"hilite")}if(t.activeYear){Calendar.removeClass(t.activeYear,"active")}t.activeYear=null;var s=t.date.getFullYear()+(q?1:-1);var l=o.firstChild;var m=false;for(var p=12;p>0;--p){if(s>=t.minYear&&s<=t.maxYear){l.innerHTML=s;l.year=s;l.style.display="block";m=true}else{l.style.display="none"}l=l.nextSibling;s+=q?t.yearStep:-t.yearStep}if(m){var i=o.style;i.display="block";if(r.navtype<0){i.left=r.offsetLeft+"px"}else{var n=o.offsetWidth;if(typeof n=="undefined"){n=50}i.left=(r.offsetLeft+r.offsetWidth-n)+"px"}i.top=(r.offsetTop+r.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(t){var F=Calendar._C;if(!F){return}var D=F.activeDiv;var x=Calendar.getTargetElement(t);if(x==D||x.parentNode==D){Calendar.addClass(D,"hilite active");Calendar.addClass(D.parentNode,"rowhilite")}else{if(typeof D.navtype=="undefined"||(D.navtype!=50&&(D.navtype==0||Math.abs(D.navtype)>2))){Calendar.removeClass(D,"active")}Calendar.removeClass(D,"hilite");Calendar.removeClass(D.parentNode,"rowhilite")}t||(t=window.event);if(D.navtype==50&&x!=D){var u=Calendar.getAbsolutePos(D);var r=D.offsetWidth;var s=t.clientX;var i;var v=true;if(s>u.x+r){i=s-u.x-r;v=false}else{i=u.x-s}if(i<0){i=0}var A=D._range;var y=D._current;var z=Math.floor(i/10)%A.length;for(var B=A.length;--B>=0;){if(A[B]==y){break}}while(z-->0){if(v){if(--B<0){B=A.length-1}}else{if(++B>=A.length){B=0}}}var E=A[B];D.innerHTML=E;F.onUpdateTime()}var C=Calendar.findMonth(x);if(C){if(C.month!=F.date.getMonth()){if(F.hilitedMonth){Calendar.removeClass(F.hilitedMonth,"hilite")}Calendar.addClass(C,"hilite");F.hilitedMonth=C}else{if(F.hilitedMonth){Calendar.removeClass(F.hilitedMonth,"hilite")}}}else{if(F.hilitedMonth){Calendar.removeClass(F.hilitedMonth,"hilite")}var w=Calendar.findYear(x);if(w){if(w.year!=F.date.getFullYear()){if(F.hilitedYear){Calendar.removeClass(F.hilitedYear,"hilite")}Calendar.addClass(w,"hilite");F.hilitedYear=w}else{if(F.hilitedYear){Calendar.removeClass(F.hilitedYear,"hilite")}}}else{if(F.hilitedYear){Calendar.removeClass(F.hilitedYear,"hilite")}}}return Calendar.stopEvent(t)};Calendar.tableMouseDown=function(b){if(Calendar.getTargetElement(b)==Calendar.getElement(b)){return Calendar.stopEvent(b)}};Calendar.calDragIt=function(f){var j=Calendar._C;if(!(j&&j.dragging)){return false}var h;var i;if(Calendar.is_ie){i=window.event.clientY+document.body.scrollTop;h=window.event.clientX+document.body.scrollLeft}else{h=f.pageX;i=f.pageY}j.hideShowCovered();var g=j.element.style;g.left=(h-j.xOffs)+"px";g.top=(i-j.yOffs)+"px";return Calendar.stopEvent(f)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}cal.hideShowCovered()};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(b){Calendar.cellClick(Calendar.getElement(b),b||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(d){var f=Calendar.getElement(d);if(Calendar.isRelated(f,d)||Calendar._C||f.disabled){return false}if(f.ttip){if(f.ttip.substr(0,1)=="_"){f.ttip=f.caldate.print(f.calendar.ttDateFormat)+f.ttip.substr(1)}f.calendar.tooltips.innerHTML=f.ttip}if(f.navtype!=300){Calendar.addClass(f,"hilite");if(f.caldate){Calendar.addClass(f.parentNode,"rowhilite");var h=f.calendar;if(h&&h.getDateToolTip){var g=f.caldate;window.status=g;f.title=h.getDateToolTip(g,g.getFullYear(),g.getMonth(),g.getDate())}}}return Calendar.stopEvent(d)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT.SEL_DATE}}};Calendar.cellClick=function(z,q){var B=z.calendar;var w=false;var t=false;var y=null;if(typeof z.navtype=="undefined"){if(B.currentDateEl){Calendar.removeClass(B.currentDateEl,"selected");Calendar.addClass(z,"selected");w=(B.currentDateEl==z);if(!w){B.currentDateEl=z}}B.date.setDateOnly(z.caldate);y=B.date;var C=!(B.dateClicked=!z.otherMonth);if(!C&&!B.currentDateEl&&B.multiple){B._toggleMultipleDate(new Date(y))}else{t=!z.disabled}if(C){B._init(B.firstDayOfWeek,y)}}else{if(z.navtype==200){Calendar.removeClass(z,"hilite");B.callCloseHandler();return}y=new Date(B.date);if(z.navtype==0){y.setDateOnly(new Date())}B.dateClicked=false;var r=y.getFullYear();var x=y.getMonth();function D(c){var b=y.getDate();var a=y.getMonthDays(c);if(b>a){y.setDate(a)}y.setMonth(c)}switch(z.navtype){case 400:Calendar.removeClass(z,"hilite");var i=Calendar._TT.ABOUT;if(typeof i!="undefined"){i+=B.showsTime?Calendar._TT.ABOUT_TIME:""}else{i='Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.scripts\nand send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n'}alert(i);return;case -2:if(r>B.minYear){y.setFullYear(r-1)}break;case -1:if(x>0){D(x-1)}else{if(r-->B.minYear){y.setFullYear(r);D(11)}}break;case 1:if(x<11){D(x+1)}else{if(r<B.maxYear){y.setFullYear(r+1);D(0)}}break;case 2:if(r<B.maxYear){y.setFullYear(r+1)}break;case 100:B.setFirstDayOfWeek(z.fdow);return;case 50:var u=z._range;var s=z.innerHTML;for(var v=u.length;--v>=0;){if(u[v]==s){break}}if(q&&q.shiftKey){if(--v<0){v=u.length-1}}else{if(++v>=u.length){v=0}}var A=u[v];z.innerHTML=A;B.onUpdateTime();return;case 0:if((typeof B.getDateStatus=="function")&&B.getDateStatus(y,y.getFullYear(),y.getMonth(),y.getDate())){return false}break}if(!y.equalsTo(B.date)){B.setDate(y);t=true}else{if(z.navtype==0){t=w=true}}}if(t){q&&B.callHandler()}if(w){Calendar.removeClass(z,"hilite");q&&B.callCloseHandler()}};Calendar.prototype.create=function(u){var v=null;if(!u){v=document.getElementsByTagName("body")[0];this.isPopup=true}else{v=u;this.isPopup=false}this.date=this.dateStr?new Date(this.dateStr):new Date();var j=Calendar.createElement("table");this.table=j;j.cellSpacing=0;j.cellPadding=0;j.calendar=this;Calendar.addEvent(j,"mousedown",Calendar.tableMouseDown);var F=Calendar.createElement("div");this.element=F;F.className="calendar";if(this.isPopup){F.style.position="absolute";F.style.display="none"}F.appendChild(j);var x=Calendar.createElement("thead",j);var t=null;var i=null;var E=this;var B=function(c,a,b){t=Calendar.createElement("td",i);t.colSpan=a;t.className="button";if(b!=0&&Math.abs(b)<=2){t.className+=" nav"}Calendar._add_evs(t);t.calendar=E;t.navtype=b;t.innerHTML="<div unselectable='on'>"+c+"</div>";return t};i=Calendar.createElement("tr",x);var D=6;(this.isPopup)&&--D;(this.weekNumbers)&&++D;B("?",1,400).ttip=Calendar._TT.INFO;this.title=B("",D,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT.DRAG_TO_MOVE;this.title.style.cursor="move";B("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE}i=Calendar.createElement("tr",x);i.className="headrow";this._nav_py=B("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT.PREV_YEAR;this._nav_pm=B("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT.PREV_MONTH;this._nav_now=B(Calendar._TT.TODAY,this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT.GO_TODAY;this._nav_nm=B("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT.NEXT_MONTH;this._nav_ny=B("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT.NEXT_YEAR;i=Calendar.createElement("tr",x);i.className="daynames";if(this.weekNumbers){t=Calendar.createElement("td",i);t.className="name wn";t.innerHTML=Calendar._TT.WK}for(var y=7;y>0;--y){t=Calendar.createElement("td",i);if(!y){t.navtype=100;t.calendar=this;Calendar._add_evs(t)}}this.firstdayname=(this.weekNumbers)?i.firstChild.nextSibling:i.firstChild;this._displayWeekdays();var z=Calendar.createElement("tbody",j);this.tbody=z;for(y=6;y>0;--y){i=Calendar.createElement("tr",z);if(this.weekNumbers){t=Calendar.createElement("td",i)}for(var A=7;A>0;--A){t=Calendar.createElement("td",i);t.calendar=this;Calendar._add_evs(t)}}if(this.showsTime){i=Calendar.createElement("tr",z);i.className="time";t=Calendar.createElement("td",i);t.className="time";t.colSpan=2;t.innerHTML=Calendar._TT.TIME||"&#160;";t=Calendar.createElement("td",i);t.className="time";t.colSpan=this.weekNumbers?4:3;(function(){function h(q,n,o,m){var l=Calendar.createElement("span",t);l.className=q;l.innerHTML=n;l.calendar=E;l.ttip=Calendar._TT.TIME_PART;l.navtype=50;l._range=[];if(typeof o!="number"){l._range=o}else{for(var r=o;r<=m;++r){var p;if(r<10&&m>=10){p="0"+r}else{p=""+r}l._range[l._range.length]=p}}Calendar._add_evs(l);return l}var d=E.date.getHours();var b=E.date.getMinutes();var c=!E.time24;var a=(d>12);if(c&&a){d-=12}var f=h("hour",d,c?1:0,c?12:23);var g=Calendar.createElement("span",t);g.innerHTML=":";g.className="colon";var k=h("minute",b,0,59);var e=null;t=Calendar.createElement("td",i);t.className="time";t.colSpan=2;if(c){e=h("ampm",a?"pm":"am",["am","pm"])}else{t.innerHTML="&#160;"}E.onSetTime=function(){var l,m=this.date.getHours(),n=this.date.getMinutes();if(c){l=(m>=12);if(l){m-=12}if(m==0){m=12}e.innerHTML=l?"pm":"am"}f.innerHTML=(m<10)?("0"+m):m;k.innerHTML=(n<10)?("0"+n):n};E.onUpdateTime=function(){var l=this.date;var p=parseInt(f.innerHTML,10);if(c){if(/pm/i.test(e.innerHTML)&&p<12){p+=12}else{if(/am/i.test(e.innerHTML)&&p==12){p=0}}}var o=l.getDate();var n=l.getMonth();var m=l.getFullYear();l.setHours(p);l.setMinutes(parseInt(k.innerHTML,10));l.setFullYear(m);l.setMonth(n);l.setDate(o);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var w=Calendar.createElement("tfoot",j);i=Calendar.createElement("tr",w);i.className="footrow";t=B(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300);t.className="ttip";if(this.isPopup){t.ttip=Calendar._TT.DRAG_TO_MOVE;t.style.cursor="move"}this.tooltips=t;F=Calendar.createElement("div",this.element);this.monthsCombo=F;F.className="combo";for(y=0;y<Calendar._MN.length;++y){var C=Calendar.createElement("div");C.className=Calendar.is_ie?"label-IEfix":"label";C.month=y;C.innerHTML=Calendar._SMN[y];F.appendChild(C)}F=Calendar.createElement("div",this.element);this.yearsCombo=F;F.className="combo";for(y=12;y>0;--y){var s=Calendar.createElement("div");s.className=Calendar.is_ie?"label-IEfix":"label";F.appendChild(s)}this._init(this.firstDayOfWeek,this.date);v.appendChild(this.element)};Calendar._keyEvent=function(p){var z=window._dynarch_popupCalendar;if(!z||z.multiple){return false}(Calendar.is_ie)&&(p=window.event);var r=(Calendar.is_ie||p.type=="keypress"),o=p.keyCode;if(p.ctrlKey){switch(o){case 37:r&&Calendar.cellClick(z._nav_pm);break;case 38:r&&Calendar.cellClick(z._nav_py);break;case 39:r&&Calendar.cellClick(z._nav_nm);break;case 40:r&&Calendar.cellClick(z._nav_ny);break;default:return false}}else{switch(o){case 32:Calendar.cellClick(z._nav_now);break;case 27:r&&z.callCloseHandler();break;case 37:case 38:case 39:case 40:if(r){var v,n,q,t,x,w;v=o==37||o==38;w=(o==37||o==39)?1:7;function y(){x=z.currentDateEl;var a=x.pos;n=a&15;q=a>>4;t=z.ar_days[q][n]}y();function u(){var a=new Date(z.date);a.setDate(a.getDate()-w);z.setDate(a)}function s(){var a=new Date(z.date);a.setDate(a.getDate()+w);z.setDate(a)}while(1){switch(o){case 37:if(--n>=0){t=z.ar_days[q][n]}else{n=6;o=38;continue}break;case 38:if(--q>=0){t=z.ar_days[q][n]}else{u();y()}break;case 39:if(++n<7){t=z.ar_days[q][n]}else{n=0;o=40;continue}break;case 40:if(++q<z.ar_days.length){t=z.ar_days[q][n]}else{s();y()}break}break}if(t){if(!t.disabled){Calendar.cellClick(t)}else{if(v){u()}else{s()}}}}break;case 13:if(r){Calendar.cellClick(z.currentDateEl,p)}break;default:return false}}return Calendar.stopEvent(p)};Calendar.prototype._init=function(N,C){var D=new Date(),I=D.getFullYear(),j=D.getMonth(),W=D.getDate();this.table.style.visibility="hidden";var Q=C.getFullYear();if(Q<this.minYear){Q=this.minYear;C.setFullYear(Q)}else{if(Q>this.maxYear){Q=this.maxYear;C.setFullYear(Q)}}this.firstDayOfWeek=N;this.date=new Date(C);var B=C.getMonth();var K=C.getDate();var i=C.getMonthDays();C.setDate(1);var H=(C.getDay()-this.firstDayOfWeek)%7;if(H<0){H+=7}C.setDate(-H);C.setDate(C.getDate()+1);var T=this.tbody.firstChild;var P=Calendar._SMN[B];var L=this.ar_days=new Array();var M=Calendar._TT.WEEKEND;var U=this.multiple?(this.datesCells={}):null;for(var F=0;F<6;++F,T=T.nextSibling){var X=T.firstChild;if(this.weekNumbers){X.className="day wn";X.innerHTML=C.getWeekNumber();X=X.nextSibling}T.className="daysrow";var E=false,S,V=L[F]=[];for(var G=0;G<7;++G,X=X.nextSibling,C.setDate(S+1)){S=C.getDate();var R=C.getDay();X.className="day";X.pos=F<<4|G;V[G]=X;var O=(C.getMonth()==B);if(!O){if(this.showsOtherMonths){X.className+=" othermonth";X.otherMonth=true}else{X.className="emptycell";X.innerHTML="&#160;";X.disabled=true;continue}}else{X.otherMonth=false;E=true}X.disabled=false;X.innerHTML=this.getDateText?this.getDateText(C,S):S;if(U){U[C.print("%Y%m%d")]=X}if(this.getDateStatus){var J=this.getDateStatus(C,Q,B,S);if(J===true){X.className+=" disabled";X.disabled=true}else{if(/disabled/i.test(J)){X.disabled=true}X.className+=" "+J}}if(!X.disabled){X.caldate=new Date(C);X.ttip="_";if(!this.multiple&&O&&S==K&&this.hiliteToday){X.className+=" selected";this.currentDateEl=X}if(C.getFullYear()==I&&C.getMonth()==j&&S==W){X.className+=" today";X.ttip+=Calendar._TT.PART_TODAY}if(M.indexOf(R.toString())!=-1){X.className+=X.otherMonth?" oweekend":" weekend"}}}if(!(E||this.showsOtherMonths)){T.className="emptyrow"}}this.title.innerHTML=Calendar._MN[B]+", "+Q;this.onSetTime();this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var d in this.multiple){var e=this.datesCells[d];var f=this.multiple[d];if(!f){continue}if(e){e.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(d){if(this.multiple){var h=d.print("%Y%m%d");var f=this.datesCells[h];if(f){var g=this.multiple[h];if(!g){Calendar.addClass(f,"selected");this.multiple[h]=d}else{Calendar.removeClass(f,"selected");delete this.multiple[h]}}}};Calendar.prototype.setDateToolTipHandler=function(b){this.getDateToolTip=b};Calendar.prototype.setDate=function(b){if(!b.equalsTo(this.date)){this._init(this.firstDayOfWeek,b)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(b){this._init(b,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(b){this.getDateStatus=b};Calendar.prototype.setRange=function(a,d){this.minYear=a;this.maxYear=d};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}this.hideShowCovered()};Calendar.prototype.destroy=function(){var b=this.element.parentNode;b.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(c){var d=this.element;d.parentNode.removeChild(d);c.appendChild(d)};Calendar._checkCalendar=function(d){var f=window._dynarch_popupCalendar;if(!f){return false}var e=Calendar.is_ie?Calendar.getElement(d):Calendar.getTargetElement(d);for(;e!=null&&e!=f.element;e=e.parentNode){}if(e==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(d)}};Calendar.prototype.show=function(){var j=this.table.getElementsByTagName("tr");for(var k=j.length;k>0;){var i=j[--k];Calendar.removeClass(i,"rowhilite");var l=i.getElementsByTagName("td");for(var g=l.length;g>0;){var h=l[--g];Calendar.removeClass(h,"hilite");Calendar.removeClass(h,"active")}}this.element.style.display="block";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"keypress",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}this.hideShowCovered()};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"keypress",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}this.element.style.display="none";this.hidden=true;this.hideShowCovered()};Calendar.prototype.showAt=function(e,f){var d=this.element.style;d.left=e+"px";d.top=f+"px";this.show()};Calendar.prototype.showAtElement=function(j,i){var g=this;var h=Calendar.getAbsolutePos(j);if(!i||typeof i!="string"){this.showAt(h.x,h.y+j.offsetHeight);return true}function f(b){if(b.x<0){b.x=0}if(b.y<0){b.y=0}var a=document.createElement("div");var c=a.style;c.position="absolute";c.right=c.bottom=c.width=c.height="0px";document.body.appendChild(a);var d=Calendar.getAbsolutePos(a);document.body.removeChild(a);if(Calendar.is_ie){d.y+=(document.documentElement&&document.documentElement.scrollTop)||document.body.scrollTop;d.x+=(document.documentElement&&document.documentElement.scrollLeft)||document.body.scrollLeft}else{d.y+=window.scrollY;d.x+=window.scrollX}var e=b.x+b.width-d.x;if(e>0){b.x-=e}e=b.y+b.height-d.y;if(e>0){b.y-=e}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var d=g.element.offsetWidth;var b=g.element.offsetHeight;g.element.style.display="none";var c=i.substr(0,1);var a="l";if(i.length>1){a=i.substr(1,1)}switch(c){case"T":h.y-=b;break;case"B":h.y+=j.offsetHeight;break;case"C":h.y+=(j.offsetHeight-b)/2;break;case"t":h.y+=j.offsetHeight-b;break;case"b":break}switch(a){case"L":h.x-=d;break;case"R":h.x+=j.offsetWidth;break;case"C":h.x+=(j.offsetWidth-d)/2;break;case"l":h.x+=j.offsetWidth-d;break;case"r":break}h.width=d;h.height=b+40;g.monthsCombo.style.display="none";f(h);g.showAt(h.x,h.y)};if(Calendar.is_khtml){setTimeout("Calendar.continuation_for_the_khtml_browser()",10)}else{Calendar.continuation_for_the_khtml_browser()}};Calendar.prototype.setDateFormat=function(b){this.dateFormat=b};Calendar.prototype.setTtDateFormat=function(b){this.ttDateFormat=b};Calendar.prototype.parseDate=function(c,d){if(!d){d=this.dateFormat}this.setDate(Date.parseDate(c,d))};Calendar.prototype.hideShowCovered=function(){if(!Calendar.is_ie&&!Calendar.is_opera){return}function D(a){var b=a.style.visibility;if(!b){if(document.defaultView&&typeof(document.defaultView.getComputedStyle)=="function"){if(!Calendar.is_khtml){b=document.defaultView.getComputedStyle(a,"").getPropertyValue("visibility")}else{b=""}}else{if(a.currentStyle){b=a.currentStyle.visibility}else{b=""}}}return b}var F=new Array("applet","iframe","select");var C=this.element;var E=Calendar.getAbsolutePos(C);var z=E.x;var B=C.offsetWidth+z;var i=E.y;var k=C.offsetHeight+i;for(var x=F.length;x>0;){var y=document.getElementsByTagName(F[--x]);var A=null;for(var v=y.length;v>0;){A=y[--v];E=Calendar.getAbsolutePos(A);var p=E.x;var t=A.offsetWidth+p;var u=E.y;var w=A.offsetHeight+u;if(this.hidden||(p>B)||(t<z)||(u>k)||(w<i)){if(!A.__msh_save_visibility){A.__msh_save_visibility=D(A)}A.style.visibility=A.__msh_save_visibility}else{if(!A.__msh_save_visibility){A.__msh_save_visibility=D(A)}A.style.visibility="hidden"}}}};Calendar.prototype._displayWeekdays=function(){var f=this.firstDayOfWeek;var g=this.firstdayname;var i=Calendar._TT.WEEKEND;for(var j=0;j<7;++j){g.className="day name";var h=(j+f)%7;if(j){g.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[h]);g.navtype=100;g.calendar=this;g.fdow=h;Calendar._add_evs(g)}if(i.indexOf(h.toString())!=-1){Calendar.addClass(g,"weekend")}g.innerHTML=Calendar._SDN[(j+f)%7];g=g.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return}this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date.parseDate=function(m,y){var j=new Date();var i=0;var x=-1;var t=0;var b=m.split(/\W+/);var d=y.match(/%./g);var u=0,v=0;var a=0;var w=0;for(u=0;u<b.length;++u){if(!b[u]){continue}switch(d[u]){case"%d":case"%e":t=parseInt(b[u],10);break;case"%m":x=parseInt(b[u],10)-1;break;case"%Y":case"%y":i=parseInt(b[u],10);(i<100)&&(i+=(i>29)?1900:2000);break;case"%b":case"%B":for(v=0;v<12;++v){if(Calendar._MN[v].substr(0,b[u].length).toLowerCase()==b[u].toLowerCase()){x=v;break}}break;case"%H":case"%I":case"%k":case"%l":a=parseInt(b[u],10);break;case"%P":case"%p":if(/pm/i.test(b[u])&&a<12){a+=12}else{if(/am/i.test(b[u])&&a>=12){a-=12}}break;case"%M":w=parseInt(b[u],10);break}}if(isNaN(i)){i=j.getFullYear()}if(isNaN(x)){x=j.getMonth()}if(isNaN(t)){t=j.getDate()}if(isNaN(a)){a=j.getHours()}if(isNaN(w)){w=j.getMinutes()}if(i!=0&&x!=-1&&t!=0){return new Date(i,x,t,a,w,0)}i=0;x=-1;t=0;for(u=0;u<b.length;++u){if(b[u].search(/[a-zA-Z]+/)!=-1){var z=-1;for(v=0;v<12;++v){if(Calendar._MN[v].substr(0,b[u].length).toLowerCase()==b[u].toLowerCase()){z=v;break}}if(z!=-1){if(x!=-1){t=x+1}x=z}}else{if(parseInt(b[u],10)<=12&&x==-1){x=b[u]-1}else{if(parseInt(b[u],10)>31&&i==0){i=parseInt(b[u],10);(i<100)&&(i+=(i>29)?1900:2000)}else{if(t==0){t=b[u]}}}}}if(i==0){i=j.getFullYear()}if(x!=-1&&t!=0){return new Date(i,x,t,a,w,0)}return j};Date.prototype.getMonthDays=function(c){var d=this.getFullYear();if(typeof c=="undefined"){c=this.getMonth()}if(((0==(d%4))&&((0!=(d%100))||(0==(d%400))))&&c==1){return 29}else{return Date._MD[c]}};Date.prototype.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var f=new Date(this.getFullYear(),0,0,0,0,0);var d=e-f;return Math.floor(d/Date.DAY)};Date.prototype.getWeekNumber=function(){var f=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var d=f.getDay();f.setDate(f.getDate()-(d+6)%7+3);var e=f.valueOf();f.setMonth(0);f.setDate(4);return Math.round((e-f.valueOf())/(7*86400000))+1};Date.prototype.equalsTo=function(b){return((this.getFullYear()==b.getFullYear())&&(this.getMonth()==b.getMonth())&&(this.getDate()==b.getDate())&&(this.getHours()==b.getHours())&&(this.getMinutes()==b.getMinutes()))};Date.prototype.setDateOnly=function(d){var c=new Date(d);this.setDate(1);this.setFullYear(c.getFullYear());this.setMonth(c.getMonth());this.setDate(c.getDate())};Date.prototype.print=function(w){var E=this.getMonth();var x=this.getDate();var s=this.getFullYear();var i=this.getWeekNumber();var d=this.getDay();var F={};var a=this.getHours();var D=(a>=12);var z=(D)?(a-12):a;var G=this.getDayOfYear();if(z==0){z=12}var C=this.getMinutes();var y=this.getSeconds();F["%a"]=Calendar._SDN[d];F["%A"]=Calendar._DN[d];F["%b"]=Calendar._SMN[E];F["%B"]=Calendar._MN[E];F["%C"]=1+Math.floor(s/100);F["%d"]=(x<10)?("0"+x):x;F["%e"]=x;F["%H"]=(a<10)?("0"+a):a;F["%I"]=(z<10)?("0"+z):z;F["%j"]=(G<100)?((G<10)?("00"+G):("0"+G)):G;F["%k"]=a;F["%l"]=z;F["%m"]=(E<9)?("0"+(1+E)):(1+E);F["%M"]=(C<10)?("0"+C):C;F["%n"]="\n";F["%p"]=D?"PM":"AM";F["%P"]=D?"pm":"am";F["%s"]=Math.floor(this.getTime()/1000);F["%S"]=(y<10)?("0"+y):y;F["%t"]="\t";F["%U"]=F["%W"]=F["%V"]=(i<10)?("0"+i):i;F["%u"]=d+1;F["%w"]=d;F["%y"]=(""+s).substr(2,2);F["%Y"]=s;F["%%"]="%";var H=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return w.replace(H,function(b){return F[b]||b})}var m=w.match(H);for(var A=0;A<m.length;A++){var B=F[m[A]];if(B){H=new RegExp(m[A],"g");w=w.replace(H,B)}}return w};window._dynarch_popupCalendar=null;