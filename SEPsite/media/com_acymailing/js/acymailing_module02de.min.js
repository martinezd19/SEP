function submitacymailingform(r,o){var d=document[o];var t=/^([a-z0-9_'&\.\-\+=])+\@(([a-z0-9\-])+\.)+([a-z0-9]{2,10})+$/i;if(!d.elements){if(d[0].elements["user[email]"]&&d[0].elements["user[email]"].value&&t.test(d[0].elements["user[email]"].value)){d=d[0]}else{d=d[d.length-1]}}if(r!="optout"){nameField=d.elements["user[name]"];if(nameField&&((typeof acymailing!="undefined"&&(nameField.value==acymailing.NAMECAPTION||(typeof acymailing["excludeValues"+o]!="undefined"&&typeof acymailing["excludeValues"+o]["name"]!="undefined"&&nameField.value==acymailing["excludeValues"+o]["name"])))||nameField.value.replace(/ /g,"").length<2)){if(typeof acymailing!="undefined"){alert(acymailing.NAME_MISSING)}nameField.className=nameField.className+" invalid";return false}}var h=d.elements["user[email]"];if(h){if(typeof acymailing=="undefined"||h.value!=acymailing.EMAILCAPTION){h.value=h.value.replace(/ /g,"")}if(!h||(typeof acymailing!="undefined"&&(h.value==acymailing.EMAILCAPTION||(typeof acymailing["excludeValues"+o]!="undefined"&&typeof acymailing["excludeValues"+o]["email"]!="undefined"&&h.value==acymailing["excludeValues"+o]["email"])))||!t.test(h.value)){if(typeof acymailing!="undefined"){alert(acymailing.VALID_EMAIL)}h.className=h.className+" invalid";return false}}if(d.elements.hiddenlists.value.length<1){var s=false;var j=d.elements["subscription[]"];if(j&&(typeof j.value=="undefined"||j.value.length==0)){for(b=0;b<j.length;b++){if(j[b].checked){s=true}}if(!s){alert(acymailing.NO_LIST_SELECTED);return false}}}if(r!="optout"&&typeof acymailing!="undefined"){if(typeof acymailing["reqFields"+o]!="undefined"&&acymailing["reqFields"+o].length>0){for(var p=0;p<acymailing["reqFields"+o].length;p++){elementName="user["+acymailing["reqFields"+o][p]+"]";elementToCheck=d.elements[elementName];if(elementToCheck){var n=false;if(typeof elementToCheck.value!="undefined"){if(elementToCheck.value==" "&&typeof d[elementName+"[]"]!="undefined"){if(d[elementName+"[]"].checked){n=true}else{for(var u=0;u<d[elementName+"[]"].length;u++){if((d[elementName+"[]"][u].checked||d[elementName+"[]"][u].selected)&&d[elementName+"[]"][u].value.length>0){n=true}}}}else{if(elementToCheck.value.replace(/ /g,"").length>0){if(typeof acymailing["excludeValues"+o]=="undefined"||typeof acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]=="undefined"||acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]!=elementToCheck.value){n=true}}}}else{for(var u=0;u<elementToCheck.length;u++){if(elementToCheck[u].checked&&elementToCheck[u].value.length>0){n=true}}}if((elementToCheck.length>=1&&(elementToCheck[0].parentElement.parentElement.style.display=="none"||elementToCheck[0].parentElement.parentElement.parentElement.style.display=="none"))||(typeof elementToCheck.length=="undefined"&&(elementToCheck.parentElement.parentElement.style.display=="none"||elementToCheck.parentElement.parentElement.parentElement.style.display=="none"))){n=true}if(!n){elementToCheck.className=elementToCheck.className+" invalid";alert(acymailing["validFields"+o][p]);return false}}else{if((d.elements[elementName+"[day]"]&&d.elements[elementName+"[day]"].value<1)||(d.elements[elementName+"[month]"]&&d.elements[elementName+"[month]"].value<1)||(d.elements[elementName+"[year]"]&&d.elements[elementName+"[year]"].value<1902)){if(d.elements[elementName+"[day]"]&&d.elements[elementName+"[day]"].value<1){d.elements[elementName+"[day]"].className=d.elements[elementName+"[day]"].className+" invalid"}if(d.elements[elementName+"[month]"]&&d.elements[elementName+"[month]"].value<1){d.elements[elementName+"[month]"].className=d.elements[elementName+"[month]"].className+" invalid"}if(d.elements[elementName+"[year]"]&&d.elements[elementName+"[year]"].value<1902){d.elements[elementName+"[year]"].className=d.elements[elementName+"[year]"].className+" invalid"}alert(acymailing["validFields"+o][p]);return false}if((d.elements[elementName+"[country]"]&&d.elements[elementName+"[country]"].value<1)||(d.elements[elementName+"[num]"]&&(d.elements[elementName+"[num]"].value<3||(typeof acymailing["excludeValues"+o]!="undefined"&&typeof acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]!="undefined"&&acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]==d.elements[elementName+"[num]"].value)))){if(d.elements[elementName+"[country]"]&&d.elements[elementName+"[country]"].value<1){d.elements[elementName+"[country]"].className=d.elements[elementName+"[country]"].className+" invalid"}if(d.elements[elementName+"[num]"]&&(d.elements[elementName+"[num]"].value<3||(typeof acymailing["excludeValues"+o]!="undefined"&&typeof acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]!="undefined"&&acymailing["excludeValues"+o][acymailing["reqFields"+o][p]]==d.elements[elementName+"[num]"].value))){d.elements[elementName+"[num]"].className=d.elements[elementName+"[num]"].className+" invalid"}alert(acymailing["validFields"+o][p]);return false}}}}if(typeof acymailing!="undefined"&&typeof acymailing["checkFields"+o]!="undefined"&&acymailing["checkFields"+o].length>0){for(var p=0;p<acymailing["checkFields"+o].length;p++){elementName="user["+acymailing["checkFields"+o][p]+"]";elementtypeToCheck=acymailing["checkFieldsType"+o][p];elementToCheck=d.elements[elementName].value;if(typeof acymailing["excludeValues"+o]!="undefined"){var l=acymailing["excludeValues"+o][acymailing["checkFields"+o][p]];if(typeof l!="undefined"&&elementToCheck==l){continue}}switch(elementtypeToCheck){case"number":myregexp=new RegExp("^[0-9]*$");break;case"letter":myregexp=new RegExp("^[A-Za-z\u00C0-\u017F ]*$");break;case"letnum":myregexp=new RegExp("^[0-9a-zA-Z\u00C0-\u017F ]*$");break;case"regexp":myregexp=new RegExp(acymailing["checkFieldsRegexp"+o][p]);break}if(!myregexp.test(elementToCheck)){alert(acymailing["validCheckFields"+o][p]);return false}}}}var q=d.elements.acycaptcha;if(q){if(q.value.length<1){if(typeof acymailing!="undefined"){alert(acymailing.CAPTCHA_MISSING)}q.className=q.className+" invalid";return false}}if(r!="optout"){var k=d.terms;if(k&&!k.checked){if(typeof acymailing!="undefined"){alert(acymailing.ACCEPT_TERMS)}k.className=k.className+" invalid";return false}if(typeof acymailing!="undefined"&&typeof acymailing["excludeValues"+o]!="undefined"){for(var e in acymailing["excludeValues"+o]){if(!acymailing["excludeValues"+o].hasOwnProperty(e)){continue}if(!d.elements["user["+e+"]"]||d.elements["user["+e+"]"].value!=acymailing["excludeValues"+o][e]){continue}d.elements["user["+e+"]"].value=""}}}if(typeof ga!="undefined"&&r!="optout"){ga("send","pageview","subscribe")}else{if(typeof ga!="undefined"){ga("send","pageview","unsubscribe")}}taskField=d.task;taskField.value=r;if(!d.elements.ajax||!d.elements.ajax.value||d.elements.ajax.value=="0"){d.submit();return false}if(window.jQuery){var c=jQuery("#"+o);c.addClass("acymailing_module_loading");c.css("filter:","alpha(opacity=50)");c.css("-moz-opacity","0.5");c.css("-khtml-opacity","0.5");c.css("opacity","0.5");data=new FormData(c[0]);jQuery.ajax({url:document.getElementById(o).action,data:data,type:"POST",async:true,success:function(a){a=JSON.parse(a);acymailingDisplayAjaxResponseJQuery(unescape(a.message),a.type,o)},error:function(){acymailingDisplayAjaxResponseJQuery("Ajax Request Failure","error",o)},cache:false,contentType:false,processData:false})}else{try{var c=document.id(o)}catch(f){var c=$(o)}data=c.toQueryString();if(typeof Ajax=="function"){new Ajax(c.action,{data:data,method:"post",onRequest:function(){c.addClass("acymailing_module_loading");c.setStyle("filter:","alpha(opacity=50)");c.setStyle("-moz-opacity","0.5");c.setStyle("-khtml-opacity","0.5");c.setStyle("opacity","0.5")},onSuccess:function(a){a=Json.evaluate(a);acymailingDisplayAjaxResponseMootools(unescape(a.message),a.type,o)},onFailure:function(){acymailingDisplayAjaxResponseMootools("Ajax Request Failure","error",o)}}).request()}else{var m=new FormData(c);c.addClass("acymailing_module_loading");c.setStyle("filter:","alpha(opacity=50)");c.setStyle("-moz-opacity","0.5");c.setStyle("-khtml-opacity","0.5");c.setStyle("opacity","0.5");var g=new XMLHttpRequest();g.open("POST",document.id(o).action);g.onload=function(){if(g.status===200){var a=JSON.parse(g.responseText);acymailingDisplayAjaxResponseMootools(unescape(a.message),a.type,o)}else{acymailingDisplayAjaxResponseMootools("Ajax Request Failure","error",o)}};g.send(m)}}return false}function acymailingDisplayAjaxResponseJQuery(g,e,c){var h=jQuery("#acymailing_togglemodule_"+c);if(h&&h.hasClass("acyactive")){var i=h.parent().parent().children()[1];jQuery(i).css("height","")}var d=jQuery("#acymailing_fulldiv_"+c+" .responseContainer")[0];if(typeof d=="undefined"){d=document.createElement("div");var a=jQuery("#acymailing_fulldiv_"+c);a.prepend(d);oldContainerHeight="0px"}else{oldContainerHeight=jQuery(d).css("height")}d.className="responseContainer";var f=jQuery("#"+c);f.removeClass("acymailing_module_loading");d.innerHTML=g;if(e=="success"){jQuery(d).addClass("acymailing_module_success")}else{jQuery(d).addClass("acymailing_module_error");f.css("filter:","alpha(opacity=100)");f.css("-moz-opacity","1");f.css("-khtml-opacity","1");f.css("opacity","1")}newContainerHeight=jQuery(d).css("height");if(e=="success"){f.animate({height:0,opacity:0})}jQuery(d).css({height:oldContainerHeight,"filter:":"alpha(opacity=0)","-moz-opacity":0,"-khtml-opacity":0,opacity:0});jQuery(d).animate({height:newContainerHeight,opacity:1})}function acymailingDisplayAjaxResponseMootools(n,j,l){try{var g=document.id("acymailing_togglemodule_"+l)}catch(f){var g=$("acymailing_togglemodule_"+l)}if(g&&g.hasClass("acyactive")){var a=g.getParent().getParent().getChildren()[1];a.setStyle("height","")}try{var i=document.getElements("#acymailing_fulldiv_"+l+" .responseContainer")[0]}catch(f){var i=$$("#acymailing_fulldiv_"+l+" .responseContainer")[0]}if(typeof i=="undefined"){i=new Element("div");try{var k=document.id("acymailing_fulldiv_"+l)}catch(f){var k=$("acymailing_fulldiv_"+l)}i.inject(k,"top");oldContainerHeight="0px"}else{oldContainerHeight=i.getStyle("height")}i.className="responseContainer";try{var c=document.id(l)}catch(f){var c=$(l)}c.removeClass("acymailing_module_loading");i.innerHTML=n;if(j=="success"){i.addClass("acymailing_module_success")}else{i.addClass("acymailing_module_error");c.setStyle("filter:","alpha(opacity=100)");c.setStyle("-moz-opacity","1");c.setStyle("-khtml-opacity","1");c.setStyle("opacity","1")}newContainerHeight=i.getStyle("height");if(typeof Ajax=="function"){if(j=="success"){var d=new Fx.Styles(c,{duration:500,transition:Fx.Transitions.linear});d.start({height:[c.getSize().size.y,0],opacity:[1,0]})}try{i.setStyle("height",oldContainerHeight+"px");i.setStyle("filter:","alpha(opacity=0)");i.setStyle("-moz-opacity","0");i.setStyle("-khtml-opacity","0");i.setStyle("opacity","0")}catch(h){}var m=new Fx.Styles(i,{duration:500,transition:Fx.Transitions.linear});m.start({height:[oldContainerHeight,newContainerHeight],opacity:[0,1]})}else{if(j=="success"){c.set("morph");c.morph({height:"0px",opacity:0});c.setStyles({display:"none"})}if(newContainerHeight!="auto"){i.setStyles({height:oldContainerHeight,opacity:0});i.set("morph");i.morph({height:newContainerHeight,opacity:1})}}};